!function(e,t){"use strict";angular.module("adf.widget.getphd",["adf.provider","llp.extract","fa.droppable","llp.parsetsv","roar","textSizeSlider","llp.pdf","LocalStorageModule","llp.extractpdf","firebase","ui.router","commonServices","xeditable","ui.tree","ngAnimate","ngAnnotateText","ngDialog","ngSanitize","pdf","phd","toastr","mentio","lionlawlabs","diff","door3.css","checklist-model","authentication","angular-md5","angular.filter","roarmap","ngFileUpload"]).config(["dashboardProvider","localStorageServiceProvider",function(e,t){t.setPrefix("adf.getphd"),e.widget("column",{title:"ColumnHeader",description:"Define groupings of widgets",templateUrl:"{widgetsPath}/getphd/src/titleTemplate.html",icon:"fa-ge",iconurl:"img/lexlab.svg",styleClass:"warning panel panel-warning",frameless:!0}).widget("getphd",{title:"+PhD",description:"import a patent prosecution history",templateUrl:"{widgetsPath}/getphd/src/view.html",controller:"MainCtrl",controllerAs:"main",frameless:!0,reload:!0,collapsed:!0,immediate:!0,icon:"fa-ge",iconurl:"img/logolong.png",styleClass:"primary panel panel-primary",edit:{templateUrl:"{widgetsPath}/getphd/src/edit.html",controller:"MainCtrl",controllerAs:"main",modalSize:"lg",reload:!0,immediate:!0},resolve:{config:["config","$firebaseArray","$rootScope","FIREBASE_URL",function(e,t,n,a){if(e.id)return e;var l=t(new Firebase(a+"content/"));return l.$add({name:"curation"}).then(function(t){var n=t.key();return t.update({id:n,ispublished:!1,content_type:"curation",timestamp:Firebase.ServerValue.TIMESTAMP}),e.appnum="10000001",e.id=n,e}),e}]}})}]).constant("FIREBASE_URL","https://lexlab.firebaseio.com/").controller("MainCtrl",["Collection","extract","fileReader","$http","parseTSV","$roarmap","$q","$scope","config","PHD","localStorageService","extractpdf","pdfToPlainText","$patentsearch","$log","FileUploader","$publish","$pdftotxt","$timeout",function(e,t,n,a,l,i,o,r,s,c,d,p,u,f,g,h,m,b,v){var y=this;if(y.size="lg",r.collapsereport=!1,y.collapse=function(){r.collapsereport=!r.collapsereport},angular.isUndefined(r.phd)){s.id||(s=r.$parent.config),y.config=s||r.$parent.$parent.config,r.definition=r.$parent.definition||null;var w=s.id||y.config.id,x=e(w);x.$bindTo(r,"phd")}r.publish=function(e){m(s.id,r.phd).then(function(e){alertify.success("link to post:"+e)})},r.configured=function(){return""!==r.config.appnum},r.notConfigured=function(){return""===r.config.appnum};var C={header:!0},S=r.uploader=new h({url:r.url||"https://lexlab.io/upload",autoUpload:!0});S.filters.push({name:"customFilter",fn:function(e,t){return this.queue.length<10}}),S.onWhenAddingFileFailed=function(e,t,n){console.info("onWhenAddingFileFailed",e,t,n)},S.onAfterAddingFile=function(e){console.info("onAfterAddingFile",e)},S.onAfterAddingAll=function(e){console.info("onAfterAddingAll",e)},S.onBeforeUploadItem=function(e){console.info("onBeforeUploadItem",e),alertify.log("starting upload...")},S.onProgressItem=function(e,t){console.info("onProgressItem",e,t)},S.onProgressAll=function(e){console.info("onProgressAll",e)},S.onSuccessItem=function(e,t,n,a){console.info("onSuccessItem",e,t,n,a)},S.onErrorItem=function(e,t,n,a){console.info("onErrorItem",e,t,n,a)},S.onCancelItem=function(e,t,n,a){console.info("onCancelItem",e,t,n,a)},S.onCompleteItem=function(e,t,n,a){console.info("onCompleteItem",e,t,n,a),alertify.success("File uploaded!"),v(function(){try{alertify.log("extracting text"),b(r.phd).then(function(e){r.phd=e,alertify.alert("history for US"+r.phd.patent.number+"has been processed and delivered to your account")})}catch(e){console.log(e),alertify.error("Im sorry... something went wrong with the extraction... please try again...")}finally{return}},5e3)},S.onCompleteAll=function(){console.info("onCompleteAll")},console.info("uploader",S),y.phd={};s.appnum;y.parse=function(e){var t=o.defer();return angular.forEach(e,function(e,n){try{}catch(a){g.error(a)}finally{return"imagefile"===e.label?r.phd.imagefile=l(e.file,C):"application"===e.label?r.phd.application=l(e.file):"attorney"===e.label?r.phd.attorney=l(e.file):"foreign"===e.label?r.phd.foreign=l(e.file,C,!1):"continuity"===e.label?r.phd.continuity=l(e.file,C,!1):"transaction"===e.label?r.phd.transaction=l(e.file,C,!1):"README"===e.label?y.info=e.file:y.error="Unhandled case!",t.resolve(r.phd)}}),t.promise},y.getfilehistory=function(e){y.spinner=!0,y.progress=0;var e=e,n="http://127.0.0.1:8080/",l="http://storage.googleapis.com/uspto-pair/applications/"+e+".zip",i={method:"GET",url:n+l,headers:{"Target-Endpoint":l}};a(i).then(function(n){y.file=n.data,console.log(n.data),t(n.data,e).then(function(e){console.log(e),y.file=e,y.parse(e).then(function(){y.spinner=!1})},function(e){y.error=e.message})})},y.remotezip=function(e){a.get("https://storage.googleapis.com/uspto-pair/applications/"+e+".zip",function(e,t){e&&(y.error=e);var n=new JSZip(t);y.handleFiles(n)})},y.success=null,y.info=null,y.handleFiles=function(e){y.error=null,y.success=null,p(e.files[0]).then(function(e){g.info("Files extracted",e),alertify.log("Files extracted"),r.phd.file=e.tsvfiles,y.parse(e.tsvfiles).then(function(e){g.info("TSV Parsed",e),alertify.log("TSV Parsed"),i(e,r.phd).then(function(e){r.phd.roarmap=e,alertify.success("ROARmap built!"),f(r.phd.application,s.PNUM).then(function(e){r.phd.patent=e,d.set(s.appnum,r.phd),alertify.log("Almost done... waiting for upload for finish ")})})},function(e){y.error=e.message})},function(e){y.error=e.messsage})},function(e){y.error=e.message},y.getFile=function(){y.progress=0,n.readAsDataUrl(y.file,y).then(function(e){y.handleFiles(e),y.imageSrc=e})},r.$on("fileProgress",function(e,t){y.progress=t.loaded/t.total}),y.pdFF=function(e){var t=o.defer();return angular.forEach(e,function(e,n){return e&&e.name.indexOf(".pdf")>-1?(u(e).then(function(e){r.phd.file.push(e)}),t.resolve(pdf)):t.reject("not a pdf")}),t.promise}}]).directive("ffFileSelect",[function(){return{restrict:"A",controller:"MainCtrl",controllerAs:"main",bindToController:!0,scope:!1,link:function(e,t,n,a){var l=a;t.on("change",function(e){l.file=(e.srcElement||e.target).files[0],l.getFile()})}}}]).factory("$patentsearch",["$q","filepickerService",function(e,t){return function(t,n){function a(e,t){var n=t,a=(e[0][1],"https://patentimages.storage.googleapis.com/pdfs/US"+n+".pdf");filepicker.storeUrl(a.toString(),{filename:"US"+n+".pdf"},function(t){var a=angular.copy(t);a.title=e[19][1],a.number=n,a.media=t.url,filepicker.convert(t,{format:"txt"},function(e){return a.txt=e.url,l.resolve(a)})})}var l=e.defer();return a(t,n),l.promise}}]).factory("$pdftotxt",["$q","filepickerService","Collection",function(e,t,n){return function(t){function a(e){var t=e.roarmap.collections[1];return n(t).$loaded().then(function(e){var t=e.roarlist;angular.forEach(t,function(e,t){n(e).$loaded().then(function(e){filepicker.storeUrl(e.selflink,{filename:e.filename},function(t){filepicker.convert(t,{format:"txt"},function(t){e.txt=t.url,e.$save(),alertify.success("text file added for"+e.title)})})})})}),l.resolve(e)}var l=e.defer();return a(t),l.promise}}]).directive("uploadQ",["FileUploader",function(e){return{restrict:"EA",template:'<div class="card"><input type="file" nv-file-select="" uploader="uploader" multiple /> <h3>Upload queue</h3> <p>Queue length: {{ uploader.queue.length }}</p> <table class="table"> <thead> <tr> <th width="50%">Name</th> <th ng-show="uploader.isHTML5">Size</th> <th ng-show="uploader.isHTML5">Progress</th> <th>Status</th> <th>Actions</th> </tr> </thead> <tbody> <tr ng-repeat="item in uploader.queue"> <td><strong>{{ item.file.name }}</strong></td> <td ng-show="uploader.isHTML5" nowrap>{{ item.file.size/1024/1024|number:2 }} MB</td> <td ng-show="uploader.isHTML5"> <div class="progress" style="margin-bottom: 0;"> <div class="progress-bar" role="progressbar" ng-style="{ \'width\': item.progress + \'%\' }"></div> </div> </td> <td class="text-center"> <span ng-show="item.isSuccess"><i class="glyphicon glyphicon-ok"></i></span> <span ng-show="item.isCancel"><i class="glyphicon glyphicon-ban-circle"></i></span> <span ng-show="item.isError"><i class="glyphicon glyphicon-remove"></i></span> </td> <td nowrap> <button type="button" class="btn btn-success btn-xs" ng-click="item.upload()" ng-disabled="item.isReady || item.isUploading || item.isSuccess"> <span class="glyphicon glyphicon-upload"></span> Upload </button> <button type="button" class="btn btn-warning btn-xs" ng-click="item.cancel()" ng-disabled="!item.isUploading"> <span class="glyphicon glyphicon-ban-circle"></span> Cancel </button> <button type="button" class="btn btn-danger btn-xs" ng-click="item.remove()"> <span class="glyphicon glyphicon-trash"></span> Remove </button> </td> </tr> </tbody> </table> <div> <div> Queue progress: <div class="progress" style=""> <div class="progress-bar" role="progressbar" ng-style="{ \'width\': uploader.progress + \'%\' }"></div> </div> </div> <button type="button" class="btn btn-success btn-s" ng-click="uploader.uploadAll()" ng-disabled="!uploader.getNotUploadedItems().length"> <span class="glyphicon glyphicon-upload"></span> Upload all </button> <button type="button" class="btn btn-warning btn-s" ng-click="uploader.cancelAll()" ng-disabled="!uploader.isUploading"> <span class="glyphicon glyphicon-ban-circle"></span> Cancel all </button> <button type="button" class="btn btn-danger btn-s" ng-click="uploader.clearQueue()" ng-disabled="!uploader.queue.length"> <span class="glyphicon glyphicon-trash"></span> Remove all </button> </div> </div>',controller:"AppController",controllerAs:"uploader",bindToController:!0,scope:{url:"@"},link:function(e,t,n,a){}}}]).controller("AppController",["$scope","FileUploader",function(e,t){var n=e.uploader=new t({url:e.url||"https://lexlab.io/upload",autoUpload:!0});n.filters.push({name:"customFilter",fn:function(e,t){return this.queue.length<10}}),n.onWhenAddingFileFailed=function(e,t,n){console.info("onWhenAddingFileFailed",e,t,n)},n.onAfterAddingFile=function(e){console.info("onAfterAddingFile",e)},n.onAfterAddingAll=function(e){console.info("onAfterAddingAll",e)},n.onBeforeUploadItem=function(e){console.info("onBeforeUploadItem",e)},n.onProgressItem=function(e,t){console.info("onProgressItem",e,t)},n.onProgressAll=function(e){console.info("onProgressAll",e)},n.onSuccessItem=function(e,t,n,a){console.info("onSuccessItem",e,t,n,a)},n.onErrorItem=function(e,t,n,a){console.info("onErrorItem",e,t,n,a)},n.onCancelItem=function(e,t,n,a){console.info("onCancelItem",e,t,n,a)},n.onCompleteItem=function(e,t,n,a){console.info("onCompleteItem",e,t,n,a)},n.onCompleteAll=function(){console.info("onCompleteAll")},console.info("uploader",n)}]),angular.module("adf.widget.getphd").run(["$templateCache",function(e){e.put("{widgetsPath}/getphd/src/edit.html",'<form role=form><div class=form-group><label for=sample>Application #</label> <input type=text class=form-control id=sample ng-model=config.appnum placeholder="Enter Application #"></div></form>'),e.put("{widgetsPath}/getphd/src/titleTemplate.html",'<button class="fa fa-close fa-2x btn-danger pull-right floatingclosebutton" onclick=$(this).parent().remove(); style=position:absolute;top:0;right:0;z-index:1;></button><div class=card-header style=z-index:0;><h4 class="bs-callout bs-callout-primary" style=color:steelblue;>{{config.title || roarevent.title}} <span class=pull-right><a title=notes ng-click="alert(\'note\')"><i class="fa fa-pencil" style=color:steelblue;></i></a> <a title=mail ng-click=$publish(this)><i class="fa fa-send" style=color:steelblue;></i></a> <a title=comment ng-click="alert(\'note\')"><i class="fa fa-comments-o" style=color:steelblue;></i></a> <a title="reload widget content" ng-click=reload()><i class="fa fa-refresh" style=color:steelblue;></i></a> <a title="change widget location" class=adf-move><i class="fa fa-arrows" style=color:steelblue;></i></a> <a title="collapse widget" ng-show="options.collapsible && !widgetState.isCollapsed" ng-click="widgetState.isCollapsed = !widgetState.isCollapsed"><i class="fa fa-minus" style=color:steelblue;></i></a> <a title="expand widget" ng-show="options.collapsible && widgetState.isCollapsed" ng-click="widgetState.isCollapsed = !widgetState.isCollapsed"><i class="fa fa-plus" style=color:steelblue;></i></a> <a title="edit widget configuration" ng-click=edit()><i class="fa fa-cog" style=color:steelblue;></i></a> <a title="fullscreen widget" ng-click=openFullScreen() ng-show="options.maximizable || true"><i class="fa fa-expand" style=color:steelblue;></i></a> <a title="remove widget" ng-click=remove() ng-if=editMode><i class="fa fa-close" style=color:steelblue;></i></a></span></h4></div>'),e.put("{widgetsPath}/getphd/src/view.html",'<div ng-controller="MainCtrl as main"><div class="alert alert-info" ng-if=notconfigured()>Please configure the +getphd widget</div><div ng-if=configured() ng-bind-html=main.content></div><button class="button button-icon fa fa-print" ng-click=publish(phd) style=position:absolute;top:-1rem;right:1rem;z-index:1000;></button><div class="card card-primary card-block btn-glass drop-target" nv-file-drop uploader=uploader drop-files=handleFiles(files) style="border: 2px dashed blue;margin: 5px;" ng-hide=phd.file><div ng-controller=pageslideCtrl><button class="row btn btn-glass btn-primary img img-rounded" ng-hide=phd.file style=position:relative;display:flex;display:-webkit-flex;align-items:center;align-content:center;justify-content:space-around;flex-direction:row; ng-click=toggle()><i class="fa fa-download fa-3x">{{config.appnum}}</i> <img src=https://lexlab.firebaseapp.com/img/GoldLogoLong.svg class="pop img img-rounded pull-right" ng-if=!config.appnum></button><div pageslide ps-open=checked ps-key-listener=true ps-side=left ps-class=card-dark><div ng-include="\'/getphdwidget/src/phd/step-1.html\'"></div><div ng-include="\'/getphdwidget/src/phd/step-2.html\'"></div><upload-q></upload-q></div><div class=row ng-hide=phd.file><div class="alert alert-danger" role=alert ng-if=main.error><strong>Uh oh!</strong> {{main.error}}</div><pre class="alert alert-info" role=alert ng-if=main.info style="color:white !important;">{{main.info}}</pre></div></div></div><div class="card card-fancy card-rounded card-block card-thick" style="text-align: left;color: #444;" ng-if=phd.file><button class="alert btn-glass btn-primary img card-rounded row" style="position:relative;display:flex;display:-webkit-flex;align-items:center;align-content:center;justify-content:space-between;flex-direction:row;background-color:#35688F;padding:2px;box-shadow:inset 10px 2px 50px rgba(0,0,0,0.5);border-top-right-radius:6rem;border-bottom-right-radius:6rem;border-left:5px ridge black;" ng-click=main.collapse()><div style=display:flex;justify-content:flex-end;flex-direction:column;align-content:flex-end;vertical-align:middle;align-items:flex-end;><h4 class="card-title ng-binding display-4" style="margin-bottom:0;color: #fff;">US {{phd.patent.number | number:0}}</h4><h5 class="card-subtitle lead ng-binding" style=color:#ddd;>USSN {{phd.application[0][1] || config.appnum}}</h5></div><img src=/llp_core/img/GoldLion.svg class=img style="width:75px;height: auto;"><div style=display:flex;flex-direction:column;align-items:flex-start;justify-content:space-around;><img src=/llp_core/img/GoldLogoLong.svg class=img style=height:45px;> <img src=/llp_core/img/GoldPhdLogoLong.svg class=img style=height:25px;padding-left:2px;></div></button><div collapse=collapsereport><tabset class=card><tab class=ngDialogTab><tab-heading class=lead>USSN {{phd.application[0][1]}}</tab-heading><h4 class="card-title pull-right">PTO Meta-Data TSVFiles</h4><tabset><tab ng-repeat="file in phd.file" heading="{{file.label | uppercase}}"><pre class="card card-block card-fancy" ng-bind=file.file></pre></tab></tabset></tab><tab class="ngDialogTab primary" ng-if=phd.application><tab-heading ng-style><span style=color:#ddd;>APPLICATION</span></tab-heading><h4 class="card-title pull-right">Application Data</h4><table class="card card-default card-block table table-striped table-hover table-condensed table-responsive"><tbody><tr ng-repeat="line in phd.application"><td ng-repeat="value in line">{{value}}</td></tr></tbody></table></tab><tab class="ngDialogTab info" ng-if=phd.attorney><tab-heading ng-style><span style=color:#ddd;>ATTORNEY</span></tab-heading><h4 class="card-title pull-right">Attorney Data</h4><table class="card card-default card-block table table-striped table-hover table-condensed table-responsive"><tbody><tr ng-repeat="line in phd.attorney"><td ng-repeat="value in line">{{value}}</td></tr></tbody></table></tab><tab class="ngDialogTab success" ng-if=phd.continuity><tab-heading ng-style><span style=color:#ddd;>CONTINUITY</span></tab-heading><h4 class="card-title pull-right">Continuity Data</h4><table class="card card-default card-block table table-striped table-condensed table-hover table-responsive"><thead><tr><th><strong>Description</strong></th><th><strong>Parent Filing or 371(c) Date</strong></th><th><strong>Parent Number</strong></th><th><strong>Parent Status</strong></th><th><strong>Patent Number</strong></th></tr></thead><tbody><tr ng-repeat="line in phd.continuity"><td>{{::line[\'Description\']}}</td><td>{{::line[\'Parent Filing or 371(c) Date\']}}</td><td>{{::line[\'Parent Number\']}}</td><td>{{::line[\'Parent Status\']}}</td><td><a ng-href="https://patentimages.storage.googleapis.com/pdfs/US{{::line[\'Patent Number\'].replace(\',\',\'\').replace(\',\',\'\')}}.pdf" target=_blank>{{::line[\'Patent Number\']}}</a></td></tr></tbody></table></tab><tab class="ngDialogTab warning" ng-if=phd.foreign><tab-heading ng-style><span style=color:#ddd;>FOREIGN PRIORITY</span></tab-heading><h4 class="card-title pull-right">Foreign Priority</h4><table class="card card-default card-block table table-striped table-condensed table-hover table-responsive"><thead><tr><th><strong>Country</strong></th><th><strong>Priority</strong></th><th><strong>Priority Date</strong></th></tr></thead><tbody><tr ng-repeat="p in phd.foreign"><td ng-bind="p[\'Country\']"></td><td ng-bind="p[\'Priority\']"></td><td ng-bind="p[\'Priority Date\'] | date"></td></tr></tbody></table></tab><tab class="ngDialogTab danger" ng-if=phd.transaction><tab-heading ng-style><span style=color:#ddd;>TRANSACTION</span></tab-heading><h4 class="card-title pull-right">Transaction Data</h4><table class="card card-default card-block table table-striped table-hover table-condensed table-responsive"><thead><tr><th><strong>Date</strong></th><th><strong>Transaction Description</strong></th></tr></thead><tbody><tr ng-repeat="trans in phd.transaction"><td>{{::trans[\'Date\']}}</td><td>{{::trans[\'Transaction Description\']}}</td></tr></tbody></table></tab><tab class=ngDialogTab ng-if=phd.imagefile><tab-heading ng-style>I F W</tab-heading><h4 class="card-title pull-right">Image File Wrapper</h4><input type=text ng-model=main.query placeholder=search... class=pull-right><table class="card card-default card-block table table-hover table-condensed table-responsive"><thead><tr><th><strong>Mail Room Date</strong></th><th><strong>Document Code</strong></th><th><strong>Document Description</strong></th><th><strong>Document Category</strong></th><th><strong>Page Count</strong></th><th><strong>Filename</strong></th></tr></thead><tbody><tr ng-repeat="roarevent in phd.imagefile |filter: main.query"><td ng-bind="roarevent[\'Mail Room Date\']"></td><td ng-bind="roarevent[\'Document Code\']"></td><td ng-bind="roarevent[\'Document Description\']"></td><td ng-bind="roarevent[\'Document Category\']"></td><td ng-bind="roarevent[\'Page Count\']"></td><td ng-bind="roarevent[\'Filename\']"></td></tr></tbody></table></tab><tab class="ngDialogTab {{collection.styleClass}}" ng-repeat="collection in phd.roarmap.collections" collection={{collection}}><tab-heading ng-style><span style=color:#ddd;><i class="fa {{collection.icon}}"></i>{{collection.rid}}</span></tab-heading><h4 class="card-title pull-right fa {{collection.icon}}">{{collection.rid}}</h4><div style="width: 100%;" class=reventlist><roar-event ng-repeat="event in collection.roarlist" id="{{event.id || event}}" style=width:19.5%;></roar-event></div></tab><tab class=ngDialogTab select="$(\'#rootwizard\').bootstrapWizard({\'tabClass\': \'nav nav-tabs\'});"><tab-heading>ROAR <label class="label label-info label-pill">{{phd.imagefile.length}}</label></tab-heading><div id=rootwizard class="tabbable tabs-left"><ul><li ng-repeat="roarevent in phd.roarmap.roarevents"><a href=#tab{{$index}} data-toggle=tab><roar-chip id="{{roarevent.id || roarevent}}"></roar-chip></a></li></ul><div class=tab-content><div class=tab-pane id=tab{{$index}} ng-repeat="roarevent in phd.roarmap.roarevents"><iframe src={{event.media}} class="card card-block card-fancy" style=width:48%;></iframe><iframe src={{event.txt}} class="card card-block card-fancy" style="width: 48%"></iframe></div><ul class="pager wizard"><li class="previous first" style=display:none;><a href=#>First</a></li><li class=previous><a href=#>Previous</a></li><li class="next last" style=display:none;><a href=#>Last</a></li><li class=next><a href=#>Next</a></li></ul></div></div><tabset class="tabbable tabs-left"><tab ng-repeat="roarevent in phd.roarmap.roarevents" select="event = roarevent"><tab-heading><roar-chip id="{{roarevent.id || roarevent}}"></roar-chip></tab-heading><div class=row><iframe src={{event.media}} class="card card-block card-fancy" style=width:48%;></iframe><iframe src={{event.txt}} class="card card-block card-fancy" style="width: 48%"></iframe></div></tab></tabset></tab><tab class=ngDialogTab><tab-heading class=lead ng-style>US {{phd.patent.number | number:0}}</tab-heading><iframe src={{phd.patent.media}} class="card card-fancy col-sm-5" style=min-height:500px;></iframe><iframe src={{phd.patent.txt}} class="card card-fancy col-sm-5" style=min-height:500px;></iframe></tab></tabset></div></div></div>'),e.put("{widgetsPath}/getphd/src/phd/step-1.html",'<div class="card card-success"><div class=card-header><h6 class=card-title>+PhD Step 1 - Download Patent</h6></div><div class=card-text><input type=text placeholder="Patent #" ng-model=config.PNUM> <a class="btn btn-success fa fa-download" href=http://patentimages.storage.googleapis.com/pdfs/US{{config.PNUM}}.pdf target=_blank data-toggle=popover data-placement=bottom data-content=DOWNLOAD data-animation=true data-trigger=hover onclick="window.open(this.href, \'\', \'resizable=no,status=no,location=no,toolbar=no,menubar=no,fullscreen=no,scrollbars=no,dependent=yes,width=400,left=150,height=30,top=150\'); return false;" style=color:white;></a></div></div>'),e.put("{widgetsPath}/getphd/src/phd/step-2.html",'<div class="card card-warning"><div class=card-header><h6 class=card-title>+PhD Step 2 - Download Image File Wrapper</h6></div><div class=card-text><input type=text placeholder="Application #" ng-model=config.appnum> <a class="btn btn-warning fa fa-download" href=https://storage.googleapis.com/uspto-pair/applications/{{config.appnum}}.zip target=_blank data-toggle=popover data-placement=bottom title="DOWNLOAD FROM GOOGLE" data-content data-animation=true data-trigger=hover style="width: 17.5rem;color:white;" onclick="window.open(this.href, \'\', \'resizable=no,status=no,location=no,toolbar=no,menubar=no,fullscreen=no,scrollbars=no,dependent=yes,width=400,left=150,height=300,top=150\'); return false;">from Google</a> <a class="btn btn-warning fa fa-download" href=https://patents.reedtech.com/downloads/pair/{{config.appnum}}.zip target=_blank data-toggle=popover data-placement=bottom title="DOWNLOAD FROM REEDTECH" data-content data-animation=true data-trigger=hover style="width: 17.5rem;color:white;" onclick="window.open(this.href, \'\', \'resizable=no,status=no,location=no,toolbar=no,menubar=no,fullscreen=no,scrollbars=no,dependent=yes,width=400,left=150,height=300,top=150\'); return false;">from ReedTech</a></div></div>'),e.put("{widgetsPath}/getphd/src/phd/step-3.html",'<div class="panel panel-danger"><div class=panel-heading><h4 class=splash>+PhD Step 3 - Unzip & Upload the Files</h4></div><div class=panel-body><h6 class=splash>{{ngDialogData[0].PNUM}} - {{ngDialogData[1].APPNUM}}</h6><span us-spinner ng-show=spinme></span><br><button class="btn btn-info fa fa-arrow-up pull-right" lk-google-picker on-picked=addfilehistory>upload</button><div ng-hide="files.length == 0"><div class="col-sm-28 col-sm-offset-1 panel sub-independent" style="padding: 1rem;"><h4>Add File History</h4><label>ID#: <input type=text ng-model=collection.rid placeholder="collection id"></label> <label class=pull-right>Box: <input type=text ng-model=collection.box placeholder="collection box"></label><br><small style="color: red;">*All Fields Required</small> <button class="btn-default pull-right" ng-click="files=[]">cancel</button> <button class="btn-info pull-right" ng-click="addfilehistory(files);spinme = true">confirm</button><br><small><strong>Note:</strong> This process may take several minutes to complete. Please wait until the process is complete. When completed, you will be brought to the results automatically.</small></div></div></div></div>')}]),angular.module("textSizeSlider",[]).directive("textSizeSlider",["$document",function(e){return{restrict:"E",template:'<div class="text-size-slider"><span class="small-letter" ng-style="{ fontSize: min + unit }">A</span> <input type="range" min="{{ min }}" max="{{ max }}" step="{{ step || 0 }}" ng-model="textSize" class="slider" value="{{ value }}" /> <span class="big-letter" ng-style="{ fontSize: max + unit }">A</span></div>',scope:{min:"@",max:"@",unit:"@",value:"@",step:"@"},link:function(t,n,a){t.textSize=t.value,t.$watch("textSize",function(n){e[0].style.fontSize=n+t.unit,$("html").style("font-size",n+t.unit)})}}}]),angular.module("roar",["angularFileUpload","pageslide-directive"]).factory("$mocks",[function(){var e={groupId:"0000x0000",matterId:"0000x0000",pId:"0000x0000",roarId:"0000x0000"};return e}]).factory("$roarevent",["OWNERSHIPDOCS","ARTDOCS","MERITSDOCS","DOCNAMES","PETDOCCODES","NOADOCCODES","INTVDOCCODES","PTODOCCODES","APPDOCCODES","$q",function(e,t,n,a,l,i,o,r,s,c){return function(e){function t(e){var t=angular.copy(e),c=e.Filename||e.name||e.filename,d=c.slice(0,c.indexOf("-")),p=c.slice(c.indexOf("-")+1,c.indexOf("-")+11),u=c.slice(c.lastIndexOf("-")+1,c.indexOf(".pdf"));t.content_type="document",e.url&&(t.media=e.url,t.uuid=e.id,t.mimeType=e.mimeType||null),t.description=e["Document Description"]||null,t.filename=e.Filename||e.name||e.filename,t.collections=[],t.application=d||null,t.date=p||null,t.doccode=e["Document Code"]||u,angular.forEach(s,function(e,n){u===e&&(t.styleClass="Applicant")}),angular.forEach(r,function(e,n){u===e&&(t.styleClass="PTO")}),angular.forEach(o,function(e,n){u===e&&(t.styleClass="Interview")}),angular.forEach(i,function(e,n){u===e&&(t.styleClass="NOA")}),angular.forEach(l,function(e,n){u===e&&(t.styleClass="Petition")}),angular.forEach(a,function(e,n){angular.forEach(e,function(e,n){u===n&&(t.name=e,t.title=e)})});var f=(new Date,new Date),g=f.getTime();return t.dashboard={model:{rows:[{columns:[{cid:g+10,styleClass:"col-sm-6",widgets:[{config:{height:"30em",url:t.media||"http://www.google.com"},title:t.title||"title",titleTemplateUrl:"{widgetsPath}/testwidget/src/title.html",type:"iframe",wid:g+100,styleClass:t.styleClass||"btn-dark"}]},{cid:g+1e3,styleClass:"col-sm-6",widgets:[{config:{draftid:"PROMISE"},title:t.title||"title",titleTemplateUrl:"{widgetsPath}/testwidget/src/title.html",type:"testwidget",wid:g+15,styleClass:t.styleClass||"btn-dark"}]}]}],structure:"ROAR-DEFAULT",title:t.title||"PROMISE",titleTemplateUrl:"../src/templates/dashboard-title.html"}},n.resolve(t)}var n=c.defer();return t(e),n.promise}}]).factory("$roarmap",["$stateParams","Matter","Collection","ROARevent","ROARevents","Collections","$mocks","$timeout","OWNERSHIPDOCS","ARTDOCS","MERITSDOCS","DOCNAMES","PETDOCCODES","NOADOCCODES","INTVDOCCODES","PTODOCCODES","APPDOCCODES","$q","PHD","$log","FIREBASE_URL",function(e,t,n,a,l,i,o,r,s,c,d,p,u,f,g,h,m,b,v,y,w){return function(n,a){function l(){var e=s();e?getroar():v()}function s(){var e=a.application[0][1],t=new Firebase(w+"content/"+e);t.once("value",function(e){return e.exists()})}function v(){angular.forEach(D,function(e,t){if(""!==e["Mail Room Date"]){var n=a.application[0][1].replace("/","").replace(",","").replace(",",""),l=(new Date,angular.copy(e)),i=new Date(e["Mail Room Date"]),o=i.getFullYear(),r=i.getMonth(),s=i.getDate(),b=e.Filename||n+"-"+o+"-"+r+"-"+s+"-00001-NPL.pdf",v=b.slice(0,b.indexOf("-")),w=b.slice(b.indexOf("-")+1,b.indexOf("-")+11),x=b.slice(b.lastIndexOf("-")+1,b.indexOf(".pdf"));l.content_type="document",l.selflink="https://lexlab.io/files/public/documents/uspto/"+v+"/"+v+"-image_file_wrapper/"+b,l.media="https://lexlab.io/files/viewer/web/viewer.html?file=%2Ffiles/public/documents/uspto/"+v+"/"+v+"-image_file_wrapper/"+b,l.description=e["Document Description"]||null,l.filename=e.Filename||null,l.collections=[],l.Application=v||null,l.date=w||null,l.rid=D.indexOf(e),l.doccode=e["Document Code"]||null,angular.forEach(m,function(e,t){x===e&&(l.styleClass="Applicant")}),angular.forEach(h,function(e,t){x===e&&(l.styleClass="PTO")}),angular.forEach(g,function(e,t){x===e&&(l.styleClass="Interview")}),angular.forEach(f,function(e,t){x===e&&(l.styleClass="NOA")}),angular.forEach(u,function(e,t){x===e&&(l.styleClass="Petition")}),angular.forEach(p,function(e,t){angular.forEach(e,function(e,t){x===t&&(l.name=e,l.title=e)})});var S=new Date,I=S.getTime();l.dashboard={model:{rows:[{columns:[{cid:I+10,styleClass:"col-sm-6",widgets:[{config:{height:"30em",url:l.media||"http://www.google.com"},title:l.title||"title",titleTemplateUrl:"{widgetsPath}/testwidget/src/title.html",type:"iframe",wid:I+100,styleClass:l.styleClass||"btn-dark"}]},{cid:I+1e3,styleClass:"col-sm-6",widgets:[{config:{draftid:"PROMISE"},title:l.title||"title",titleTemplateUrl:"{widgetsPath}/testwidget/src/title.html",type:"testwidget",wid:I+1010,styleClass:l.styleClass||"btn-dark"}]}]}],structure:"ROAR-DEFAULT",title:l.title||"PROMISE",titleTemplateUrl:"../src/templates/dashboard-title.html"}},A.$add(l).then(function(e){var t=e.key();console.log("added record with id "+t),e.update({id:t,timestamp:Firebase.ServerValue.TIMESTAMP}),e.child("dashboard").child("model").child("rows").child("0").child("columns").child("1").child("widgets").child("0").child("config").child("draftid").set(t),P.filelist.push(t),C.roarevents.push(t),angular.forEach(d,function(e,n){l.doccode===e&&(P.meritslist.push(t),y.info("merits",t))}),angular.forEach(c,function(e,n){l.doccode===e&&(P.artlist.push(t),y.info("art",t))}),alertify.log("added record with id "+t)})}}),r(function(){x(P)},5e3)}function x(t){var n={name:"USSN "+a.application[0][1],title:"USSN "+a.application[0][1],rid:"PHD1 - ALL",collectiontype:"source",box:"PhD for USSN "+a.application[0][1],styleClass:"success",app:a.application[0][1],content_type:"collection",roarlist:t.filelist},l={name:"USSN "+a.application[0][1],title:"USSN "+a.application[0][1],rid:"PHD2 - MERITS",collectiontype:"source",box:"PhD for USSN "+a.application[0][1],styleClass:"danger",app:a.application[0][1],content_type:"collection",roarlist:t.meritslist},i={name:"USSN "+a.application[0][1],title:"USSN "+a.application[0][1],rid:"PHD3 - ART",collectiontype:"source",box:"PhD for USSN "+a.application[0][1],styleClass:"warning",app:a.application[0][1],content_type:"collection",roarlist:t.artlist},r=[n,l,i];return angular.forEach(r,function(t,n){A.$add(t).then(function(t){var n=t.key();t.update({id:n,timestamp:Firebase.ServerValue.TIMESTAMP,matter:e.matterId||o.stateParams.matterId,project:e.pId||o.stateParams.pId}),C.collections.push(n)})}),S.resolve(C)}var C={collections:new Array,roarevents:new Array},S=b.defer(),A=(t(e.matterId,e.groupId),i()),D=a.imagefile,P={filelist:new Array,meritslist:new Array,artlist:new Array};return l(),S.promise}}]).controller("PageslideCtrl",["$scope",function(e){
e.checked=!1,e.toggle=function(){e.checked=!e.checked},e.checked1=!1,e.toggle1=function(){e.checked1=!e.checked1},e.checked2=!1,e.toggle2=function(){e.checked2=!e.checked2}}]),angular.module("llp.pdf",["LocalStorageModule"]).config(["localStorageServiceProvider",function(e){e.setPrefix("adf.getphd")}]).factory("pdfToPlainText",["$q",function(e){function t(t){var a=e.defer();PDFJS.disableWorker=!1,console.log(t);var l=PDFJS.getDocument(t.data);return l.then(n),a.promise}return function(e){t(e)};var n}]).directive("getpdftext",["extract","$document","$window","$rootScope",function(e,t,n,a){var l=function(e,t,n,a){e.pdfToPlainText=function(t){var n={title:"pdfData",content:'<div id="pdf"></div>'};e.phd.documents.push(n),PDFJS.disableWorker=!1,$("#pdf").children().remove();var a=PDFJS.getDocument(t);a.then(l)};var l=function(e){for(var t=0;t<e.numPages;t++)e.getPage(t+1).then(o)},i="</section><section class='page card card-fancy'>",o=function(t){var n=angular.element(i).appendTo("#pdf");t.getTextContent().then(function(t){console.log(t),angular.forEach(t,function(t,a){var l="";angular.forEach(t,function(e,t){return l+=e.str}),$(n).append(l),e.pages.push(l)})})}};return{restrict:"A",controller:"PDFFilesController",controllerAs:"pdff",bindToController:!0,link:l}}]).controller("PDFFilesController",["$scope","extract","$document","$window","$http","localStorageService",function(e,t,n,a,l,i){var o=this;o.name="PDFFilesController"}]),angular.module("llp.parsetsv",[]).factory("parseTSV",[function(){return function(e,t,n){var a=e,t=t,l=Papa.parse(a,t);return n?l:l.data}}]),function(e){var t=function(t,n){var t=e(t),a=this,l=e.extend({},e.fn.bootstrapWizard.defaults,n),i=null,o=null;this.rebindClick=function(e,t){e.unbind("click",t).bind("click",t)},this.fixNavigationButtons=function(){return i.length||(o.find("a:first").tab("show"),i=o.find("li:first")),e(l.previousSelector,t).toggleClass("disabled",a.firstIndex()>=a.currentIndex()),e(l.nextSelector,t).toggleClass("disabled",a.currentIndex()>=a.navigationLength()),a.rebindClick(e(l.nextSelector,t),a.next),a.rebindClick(e(l.previousSelector,t),a.previous),a.rebindClick(e(l.lastSelector,t),a.last),a.rebindClick(e(l.firstSelector,t),a.first),l.onTabShow&&"function"==typeof l.onTabShow&&l.onTabShow(i,o,a.currentIndex())===!1?!1:void 0},this.next=function(e){return t.hasClass("last")?!1:l.onNext&&"function"==typeof l.onNext&&l.onNext(i,o,a.nextIndex())===!1?!1:($index=a.nextIndex(),void($index>a.navigationLength()||o.find("li:eq("+$index+") a").tab("show")))},this.previous=function(e){return t.hasClass("first")?!1:l.onPrevious&&"function"==typeof l.onPrevious&&l.onPrevious(i,o,a.previousIndex())===!1?!1:($index=a.previousIndex(),void($index<0||o.find("li:eq("+$index+") a").tab("show")))},this.first=function(e){return l.onFirst&&"function"==typeof l.onFirst&&l.onFirst(i,o,a.firstIndex())===!1?!1:t.hasClass("disabled")?!1:void o.find("li:eq(0) a").tab("show")},this.last=function(e){return l.onLast&&"function"==typeof l.onLast&&l.onLast(i,o,a.lastIndex())===!1?!1:t.hasClass("disabled")?!1:void o.find("li:eq("+a.navigationLength()+") a").tab("show")},this.currentIndex=function(){return o.find("li").index(i)},this.firstIndex=function(){return 0},this.lastIndex=function(){return a.navigationLength()},this.getIndex=function(e){return o.find("li").index(e)},this.nextIndex=function(){return o.find("li").index(i)+1},this.previousIndex=function(){return o.find("li").index(i)-1},this.navigationLength=function(){return o.find("li").length-1},this.activeTab=function(){return i},this.nextTab=function(){return o.find("li:eq("+(a.currentIndex()+1)+")").length?o.find("li:eq("+(a.currentIndex()+1)+")"):null},this.previousTab=function(){return a.currentIndex()<=0?null:o.find("li:eq("+parseInt(a.currentIndex()-1)+")")},this.show=function(e){return t.find("li:eq("+e+") a").tab("show")},this.disable=function(e){o.find("li:eq("+e+")").addClass("disabled")},this.enable=function(e){o.find("li:eq("+e+")").removeClass("disabled")},this.hide=function(e){o.find("li:eq("+e+")").hide()},this.display=function(e){o.find("li:eq("+e+")").show()},this.remove=function(t){var n=t[0],a="undefined"!=typeof t[1]?t[1]:!1,l=o.find("li:eq("+n+")");if(a){var i=l.find("a").attr("href");e(i).remove()}l.remove()},o=t.find("ul:first",t),i=o.find("li.active",t),o.hasClass(l.tabClass)||o.addClass(l.tabClass),l.onInit&&"function"==typeof l.onInit&&l.onInit(i,o,0),l.onShow&&"function"==typeof l.onShow&&l.onShow(i,o,a.nextIndex()),a.fixNavigationButtons(),e('a[data-toggle="tab"]',o).on("click",function(t){var n=o.find("li").index(e(t.currentTarget).parent("li"));return l.onTabClick&&"function"==typeof l.onTabClick&&l.onTabClick(i,o,a.currentIndex(),n)===!1?!1:void 0}),e('a[data-toggle="tab"]',o).on("shown",function(t){$element=e(t.target).parent();var n=o.find("li").index($element);return $element.hasClass("disabled")?!1:l.onTabChange&&"function"==typeof l.onTabChange&&l.onTabChange(i,o,a.currentIndex(),n)===!1?!1:(i=$element,void a.fixNavigationButtons())})};e.fn.bootstrapWizard=function(n){if("string"==typeof n){var a=Array.prototype.slice.call(arguments,1);return 1===a.length&&a.toString(),this.data("bootstrapWizard")[n](a)}return this.each(function(a){var l=e(this);if(!l.data("bootstrapWizard")){var i=new t(l,n);l.data("bootstrapWizard",i)}})},e.fn.bootstrapWizard.defaults={tabClass:"nav nav-pills",nextSelector:".wizard li.next",previousSelector:".wizard li.previous",firstSelector:".wizard li.first",lastSelector:".wizard li.last",onShow:null,onInit:null,onNext:null,onPrevious:null,onLast:null,onFirst:null,onTabChange:null,onTabClick:null,onTabShow:null}}(jQuery),angular.module("adf.widget.getphd").factory("fileReader",["$q","$log",function(e,t){var n=function(e,t,n){return function(){t.resolve(e.result)}},a=function(e,t,n){return function(){t.reject(e.result)}},l=function(e,t){return function(e){}},i=function(e,t){var i=new FileReader;return i.onload=n(i,e,t),i.onerror=a(i,e,t),i.onprogress=l(i,t),i},o=function(t,n){var a=e.defer(),l=i(a,n);return l.readAsDataURL(t),a.promise};return{readAsDataUrl:o}}]),angular.module("llp.extractpdf",[]).factory("extractpdf",["$q",function(e){function t(t,n){var a=n||t.name.slice(0,t.name.indexOf(".")),l=e.defer(),i=new FileReader,o=a,r=o+"/"+o+"-address_and_attorney_agent.tsv",s=o+"/"+o+"-application_data.tsv",c=o+"/"+o+"-continuity_data.tsv",d=o+"/"+o+"-foreign_priority.tsv",p=o+"/"+o+"-transaction_history.tsv",u=o+"/"+o+"-image_file_wrapper/"+o+"-image_file_wrapper.tsv",f=o+"/README.txt",g=[{label:"README",value:f},{label:"attorney",value:r},{label:"application",value:s},{label:"continuity",value:c},{label:"foreign",value:d},{label:"transaction",value:p},{label:"imagefile",value:u}];return i.onerror=l.reject.bind(l),i.onload=function(e){i.result||l.reject(new Error("Unknown error"));var t=new JSZip(i.result,{binary:!0}),n={tsvfiles:new Array,pdffiles:t.files};return angular.forEach(g,function(e,a){var l=t.files[e.value];"undefined"!=typeof l&&n.tsvfiles.push({label:e.label,file:l.asText()})}),l.resolve(n)},i.readAsArrayBuffer(t),l.promise}function n(e,n){return t(e,n)}return n}]),angular.module("llp.extract",[]).factory("extract",["$q",function(e){function t(t,n){var a=n||t.name.slice(0,t.name.indexOf(".")),l=e.defer(),i=new FileReader,o=a,r=o+"/"+o+"-address_and_attorney_agent.tsv",s=o+"/"+o+"-application_data.tsv",c=o+"/"+o+"-continuity_data.tsv",d=o+"/"+o+"-foreign_priority.tsv",p=o+"/"+o+"-transaction_history.tsv",u=o+"/"+o+"-image_file_wrapper/"+o+"-image_file_wrapper.tsv",f=o+"/README.txt",g=[{label:"README",value:f},{label:"attorney",value:r},{label:"application",value:s},{label:"continuity",value:c},{label:"foreign",value:d},{label:"transaction",value:p},{label:"imagefile",value:u}];return i.onerror=l.reject.bind(l),i.onload=function(e){i.result||l.reject(new Error("Unknown error"));var t=new JSZip(i.result,{binary:!0}),n=[];return angular.forEach(g,function(e,a){var l=t.files[e.value];"undefined"!=typeof l&&n.push({label:e.label,file:l.asText()})}),l.resolve(n)},i.readAsArrayBuffer(t),l.promise}function n(e,n){return t(e,n)}return n}]),jQuery.event.props.push("dataTransfer"),angular.module("fa.droppable",[]).directive("dropFiles",[function(){var e=function(e,t,n,a){var l=function(e){for(var t=e.originalEvent.dataTransfer.files,n=[],a=0,l=t.length;l>a;a++)n.push(t[a]);return n},i=function(e){e.preventDefault(),t.css({"border-style":"dotted"})},o=function(e){e.preventDefault(),t.css({"border-style":"dashed"});var n=l(e);a.dropFiles({files:n})};t.on("dragover",i),t.on("drop",o),e.$on("$destroy",function(){t.off("dragover",i),t.off("drop",o)})};return{restrict:"A",controller:"DropFilesController",controllerAs:"drop",bindToController:!0,require:"dropFiles",scope:{accepts:"&",dropFiles:"&",main:"&"},link:e}}]).controller("DropFilesController",["$controller","extract","$scope","$timeout","$rootScope","FileUploader",function(e,t,n,a,l,i){var o=this,r=n.uploader=new i({url:n.url||"https://lexlab.io/upload",autoUpload:!0});r.filters.push({name:"customFilter",fn:function(e,t){return this.queue.length<10}}),r.onWhenAddingFileFailed=function(e,t,n){console.info("onWhenAddingFileFailed",e,t,n)},r.onAfterAddingFile=function(e){console.info("onAfterAddingFile",e)},r.onAfterAddingAll=function(e){console.info("onAfterAddingAll",e)},r.onBeforeUploadItem=function(e){console.info("onBeforeUploadItem",e)},r.onProgressItem=function(e,t){console.info("onProgressItem",e,t)},r.onProgressAll=function(e){console.info("onProgressAll",e)},r.onSuccessItem=function(e,t,n,a){console.info("onSuccessItem",e,t,n,a)},r.onErrorItem=function(e,t,n,a){console.info("onErrorItem",e,t,n,a)},r.onCancelItem=function(e,t,n,a){console.info("onCancelItem",e,t,n,a)},r.onCompleteItem=function(e,t,n,a){console.info("onCompleteItem",e,t,n,a)},r.onCompleteAll=function(){console.info("onCompleteAll")},console.info("uploader",r),o.file={},o.dropFiles=function(e){console.log("files.files[0]",e.files[0]),n.$parent.main.handleFiles(e)}}])}(window);